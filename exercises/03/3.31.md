è¿™ä¸ªé¢˜å›°æ‰°äº†æˆ‘å¥½å‡ å¤©ï¼Œè¦æƒ³è§£å†³è¿™ä¸ªé¢˜ç›®ï¼Œæˆ‘æ˜¯æŒ‰ç…§é¢˜ç›®è¯´æ˜ï¼Œæ‹¿`half-adder`ä¸ºä¾‹å­ï¼Œæ¥åˆ†æå¦‚æœåœ¨`add-action!`ä¸­ä¸ç«‹å³è°ƒç”¨`(proc)`æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

è¿™é¢˜ç½‘ä¸Šçš„è¯´æ³•ä¸€èˆ¬æ˜¯ï¼š

> å¦‚æœæ²¡æœ‰ç«‹å³æ‰§è¡Œ`(proc)`ï¼Œé‚£ä¹ˆ`agenda`é‡Œé¢å°±æ²¡æœ‰å¾…å¤„ç†è¿‡ç¨‹äº†ã€‚

å…¶å®è¿™æ˜¯**ä¸å‡†ç¡®çš„**ï¼Œå› ä¸ºåœ¨æ”¹å˜ä¸€ä¸ªç”µçº¿çš„ä¿¡å·æ—¶ï¼Œå¦‚æœå’Œå…¶ä¹‹å‰çš„ä¿¡å·ä¸ä¸€æ ·ï¼Œä¼šè§¦å‘è¯¥ç”µçº¿ä¸Šæ‰€æœ‰çš„`action-procedures`ï¼Œé‚£ä¹ˆè¿™æ—¶ä¹Ÿä¼šè°ƒç”¨`after-delay`è¿‡ç¨‹ï¼Œä¹Ÿå³å‘`agenda`ä¸­æ·»åŠ å¾…å¤„ç†è¿‡ç¨‹äº†ã€‚

å…¶å®ï¼Œåœ¨`add-action!`ä¸­ç«‹å³æ‰§è¡Œ`(proc)`ï¼Œä¸»è¦çš„ç›®çš„æ˜¯ï¼š

> å¯ä»¥åœ¨ç”µçº¿ä¿¡å·ä¸æ”¹å˜æ—¶ï¼Œä¹Ÿè°ƒç”¨`after-delay`è¿‡ç¨‹ï¼Œå‘`agenda`ä¸­æ·»åŠ å¾…å¤„ç†è¿‡ç¨‹ã€‚

ä¸‹é¢æ¥å…·ä½“åˆ†æ`half-adder`åœ¨`add-action!`ä¸­**ä¸**ç«‹å³æ‰§è¡Œ`(proc)`æ—¶`agenda`çš„å˜åŒ–ï¼Œæ¥ä½è¯ä¸Šé¢è¿™ä¸ªæ€»ç»“ã€‚
```
(load "lib/queue.scm")
(load "lib/simulator.scm")
; æµ‹è¯•æ—¶ï¼Œéœ€è¦æŠŠ add-action! ä¸­çš„ (proc) è°ƒç”¨æ³¨é‡Šæ‰ ğŸ˜Š
(define a (make-wire))
(define b (make-wire))
(define s (make-wire))
(define c (make-wire))
(define (half-adder a b s c)
  (let ((d (make-wire))
        (e (make-wire)))
    (or-gate a b d)
    (and-gate a b c)
    (inverter c e)
    (and-gate d e s)
    "ok"))
(half-adder a b s c)
(set-signal! a 1)
(propagate)
```

ä¸Šé¢æ˜¯å®Œæ•´çš„æµ‹è¯•ç¨‹åºï¼Œä¸‹é¢æ¥åˆ†ææ‰§è¡Œæœ€åä¸‰ä¸ªè¿‡ç¨‹æ—¶ï¼Œ`agenda`çš„å˜åŒ–ï¼š

1. `(half-adder a b s c)`

  è°ƒç”¨ half-adderï¼Œå°†å„ä¸ªç”µçº¿è¿æ¥èµ·æ¥ï¼Œè¿™æ—¶ agenda ä¸ºç©º    
2.  `(set-signal! a 1)`

  ç°åœ¨å°† a çš„ä¿¡å·ç½®ä¸º1ï¼Œè¿™æ—¶ä¸‹é¢ä¸¤ä¸ªè¿‡ç¨‹å°†ä¼šè¢«æ·»åŠ åˆ° agenda ä¸­
  1. `(set-signal! d (logical-or 1 0))` or of a and b
  2. `(set-signal! c (logical-and 1 0))` and of a and b
3. `(propagate)`

  å¼€å§‹å¯åŠ¨ä»¿çœŸå™¨ï¼Œè¿™æ—¶ä¼šå»æ‰§è¡Œ agenda ä¸­çš„ä»…æœ‰çš„ä¸¤ä¸ªè¿‡ç¨‹ï¼ˆåœ¨æ­¥éª¤2ä¸­æ·»åŠ çš„ï¼‰ã€‚
  `(set-signal! d (logical-or 1 0))`æ‰§è¡Œåï¼Œç”±äºæ”¹å˜äº† d çš„å€¼ï¼Œæ‰€ä»¥ä¼šæŠŠä¸‹é¢çš„è¿‡ç¨‹æ·»åŠ åˆ° agenda ä¸­`(set-signal! s (logical-and 1 0))`ã€‚
  
  è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ`(logical 1 0)`çš„ç¬¬äºŒä¸ªå‚æ•°ä¹‹æ‰€ä»¥ä¸º0ï¼Œæ˜¯å› ä¸º`(set-signal! c (logical-and 1 0))`æ‰§è¡Œåï¼Œç”±äºç”µçº¿ c çš„ä¿¡å·ä»æ²¡æ”¹å˜è¿‡ï¼Œæ‰€ä»¥`(invert-input 0)`è¿‡ç¨‹ä¸ä¼šè¢«æ·»åŠ åˆ° agenda ä¸­ï¼Œæ‰€ä»¥ç”µçº¿ e çš„ä¿¡å·å°†ä¸€ç›´ä¿æŒä¸º 0ï¼Œæ‰€ä»¥ s çš„æœ€ç»ˆå€¼ä¸º0.

4. è€Œå®é™…ä¸Šï¼Œs çš„æœ€ç»ˆå€¼åº”è¯¥æ˜¯1æ‰èƒ½ï¼Œå¦‚æœåœ¨`add-action!`ä¸­ç«‹å³æ‰§è¡Œ`(proc)`ï¼Œå°±èƒ½å¤Ÿé¿å…ä¸Šé¢æ­¥éª¤3æ‰€å‡ºç°çš„é—®é¢˜äº†ã€‚

é€šè¿‡ä¸Šé¢çš„åˆ†æï¼ŒåŸºæœ¬ä¸Šèƒ½å¤Ÿç†è§£ä¸ºä»€ä¹ˆè¦åœ¨`add-action!`ä¸­ç«‹å³æ‰§è¡Œ`(proc)`äº†ã€‚

## å‚è€ƒé“¾æ¥ï¼š

- http://sicp-himanshu.blogspot.hk/2009/08/ex-328-332.html